<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:insert="~{fragments/adminlayout.html}">

<main class="container-fluid" th:fragment="content">

    <div class="card mt-3 bg-white">
        <div class="card-header">

            <div class="card-title ">
                News & Notices
                <button type="button" class="btn btn-primary float-end" data-bs-toggle="modal"
                        data-bs-target="#exampleModal">
                    Add News/Notice
                </button>
            </div>


            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="exampleModalLabel">Add News/Notice</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="addNewsForm" th:action="@{/secure/news/add}" method="post"
                                  enctype="multipart/form-data">
                                <div class="form-group my-3">
                                    <label for="newsType">News Type:</label>
                                    <select class="form-control" id="newsType" name="newsType" required>
                                        <option value="" selected disabled>-Select News Type-</option>
                                        <option value="">Career</option>
                                        <option value="">General</option>
                                        <option value="">Advertisement</option>
                                        <option value="">Placement</option>
                                    </select>
                                </div>
                                <div class="form-group my-3">
                                    <label for="title">Title:</label>
                                    <input type="text" class="form-control" id="title" name="title" required/>
                                </div>

                                <div class="form-group my-3">
                                    <label for="description">Description:</label>
                                    <textarea class="form-control" id="description" name="description"
                                              required></textarea>
                                </div>

                                <div class="form-group my-3">
                                    <label for="date">Date:</label>
                                    <input type="date" class="form-control" id="date" name="date"
                                           placeholder="YYYY-MM-DD" required/>
                                </div>

                                <div class="form-group my-3">
                                    <label for="attachment">Attachment:</label>
                                    <input type="file" class="form-control" id="attachment" name="attachment"/>
                                </div>

                                <div class="text-center mt-5">
                                    <button type="submit" class="btn btn-primary">Add News</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-body">
            <table class="table table-striped">
                <thead class="table-dark">
                <tr>
                    <th>Slno</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Date</th>
                    <th>Attatchment</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>1</td>
                    <td>TEST</td>
                    <td>This is test news</td>
                    <td>28-01-2024</td>
                    <td><a href="#" class="btn btn-success">View</a></td>
                    <td><a href="#" class="btn btn-danger"><i class="fa-solid fa-trash-can"></i></a></td>

                </tr>
                <!-- Iterate over the list of news and display each row -->
<!--                <tr th:each="news, iterStat : ${newsList}">-->
<!--                    <td th:text="${iterStat.index + 1}"></td>-->
<!--                    <td th:text="${news.title}"></td>-->
<!--                    <td th:text="${news.description}"></td>-->
<!--                    <td th:text="${#dates.format(news.date, 'yyyy-MM-dd')}"></td>-->
<!--                    &lt;!&ndash; Add any action buttons or links here &ndash;&gt;-->
<!--                    <td>-->
<!--                        &lt;!&ndash; Example: Edit link &ndash;&gt;-->
<!--                        <a th:href="@{/secure/news/edit/{id}(id=${news.id})}" class="btn btn-primary">Edit</a>-->
<!--                    </td>-->
<!--                </tr>-->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Include SweetAlert library -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Your JavaScript code -->
    <script th:inline="javascript">
        document.getElementById('addNewsForm').addEventListener('submit', function (event) {
            event.preventDefault();

            var formData = new FormData(this);

            fetch(this.action, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                Swal.fire({
                    icon: 'success',
                    title: 'News Saved Successfully!',
                    showConfirmButton: false,
                    timer: 1500
                });

                setTimeout(function() {
                    window.location.href = '/secure/news';
                }, 2000);
            })
            .catch(error => {
                console.error('Error adding news:', error);
            });
        });
    </script>
</main>
</html>